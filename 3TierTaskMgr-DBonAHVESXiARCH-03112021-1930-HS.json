{"status":{},"contains_secrets":true,"product_version":"3.1.1","spec":{"description":"03\/12\/21\n3 Tier Laravel Task List Application:\nFor AWS Security Group need to open ports 22, 80 and 3306 - do it for 0.0.0.0\/0 unless you can figure out the outgoing IP address for your HPOC.\nSupports DB Server on AHV and Web servers on AWS \/ DB Server on ESXi and Web Servers on AWS - use reverse SSH tunnel with \"webadmin\" userid for web server to DB Server comms - so you don't need a VPN.  make sure you enter a passoword for the Mysql_password variable - this password is also used for the webadmin userid for setting u the resverse ssh tunnels.  Supports up to 4x webservers - when a user (via the loadbalancer) goes to the web page the color of the background ob the displayed app is different fear each targeted webserver. RESTART\/START Actions  not implemented.  hardev@nutanix.com\n","resources":{"client_attrs":{"f31e09eb_deployment":{"y":336.0702970694,"x":192.8713272425},"366fc8f8_deployment":{"y":342.5812506032,"x":882.75},"f74e1dc8_deployment":{"y":360.2388763792,"x":517.3388188793},"5de2c08a_deployment":{"y":360.2388763792,"x":517.3388188793},"946a9f13_deployment":{"y":336.0702970694,"x":192.8713272425},"f12a6ca1_deployment":{"y":342.5812506032,"x":882.75},"38d2f5e7_deployment":{"y":360.2388763792,"x":517.3388188793},"59074ea2_deployment":{"y":360.2388763792,"x":517.3388188793},"None":{"y":360.2388763792,"x":517.3388188793},"92495e87_deployment":{"y":360.2388763792,"x":517.3388188793},"0b532cbd_deployment":{"y":336.0702970694,"x":192.8713272425},"a29f6669_deployment":{"y":342.5812506032,"x":882.75},"47f2b937_deployment":{"y":336.0702970694,"x":192.8713272425},"83b7b9a6_deployment":{"y":336.0702970694,"x":192.8713272425},"b5ceb830_deployment":{"y":342.5812506032,"x":882.75},"59411acb_deployment":{"y":342.5812506032,"x":882.75}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b078e286_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"56bd9b18_runbook","main_task_local_reference":{"kind":"app_task","name":"b078e286_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"4b4aedf8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"13275ff3_runbook","main_task_local_reference":{"kind":"app_task","name":"4b4aedf8_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"f7f25ab5_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"5b133933_runbook","main_task_local_reference":{"kind":"app_task","name":"f7f25ab5_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e8c6e037_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"1fd364d8_runbook","main_task_local_reference":{"kind":"app_task","name":"e8c6e037_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"5e1c4a72_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"086d6a94_runbook","main_task_local_reference":{"kind":"app_task","name":"5e1c4a72_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"MySQL","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"f7d6db17_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"edbeed94_runbook","main_task_local_reference":{"kind":"app_task","name":"f7d6db17_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"5ca6a354_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"f5516632_runbook","main_task_local_reference":{"kind":"app_task","name":"5ca6a354_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b963f15a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"bd4b3ff6_runbook","main_task_local_reference":{"kind":"app_task","name":"b963f15a_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3d43bb3e_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"35cb9a65_runbook","main_task_local_reference":{"kind":"app_task","name":"3d43bb3e_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"14e5c730_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"df8ba106_runbook","main_task_local_reference":{"kind":"app_task","name":"14e5c730_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"MySQL"}],"name":"WebServer","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a496f54c_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"2363c107_runbook","main_task_local_reference":{"kind":"app_task","name":"a496f54c_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c013f4a6_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"17b00c77_runbook","main_task_local_reference":{"kind":"app_task","name":"c013f4a6_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"cfcd2de5_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"b6419d19_runbook","main_task_local_reference":{"kind":"app_task","name":"cfcd2de5_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"078d0601_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"2cdf5e51_runbook","main_task_local_reference":{"kind":"app_task","name":"078d0601_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"96aa202b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"39d4e399_runbook","main_task_local_reference":{"kind":"app_task","name":"96aa202b_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"WebServer"}],"name":"HAProxy","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AHV_VM","name":"MySQLAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-DB-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"5518184e-3a1a-4fdd-be9d-0759dbf971dc"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"b2ecc125-cb67-4a55-bec6-403506263591","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_7_Cloud","uuid":"94b7eb9c-73a5-4b7e-a9c9-784b6b181f5f"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"WebServerAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-WEB-@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"5518184e-3a1a-4fdd-be9d-0759dbf971dc"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"b2ecc125-cb67-4a55-bec6-403506263591","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_7_Cloud","uuid":"94b7eb9c-73a5-4b7e-a9c9-784b6b181f5f"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"HAProxyAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-HAP-@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"5518184e-3a1a-4fdd-be9d-0759dbf971dc"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"b2ecc125-cb67-4a55-bec6-403506263591","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_7_Cloud","uuid":"94b7eb9c-73a5-4b7e-a9c9-784b6b181f5f"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AWS_VM","name":"MySQLec2_B","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{public_ip_address}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-vm-DB-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-west-2a","subnet_id":"subnet-36f4364e","key_name":"Oregon-CALM","region":"us-west-2","instance_initiated_shutdown_behavior":"","user_data":"","image_id":"ami-0818f9dfe739b171e","instance_type":"t2.micro","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-e21ce1b0"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/xvda","iops":100,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-059fee7d","tag_list":[],"type":"","account_uuid":"823417e9-8260-3d4d-e42d-11791071cb87","associate_public_ip_address":true}},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"WebServerec2_B","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-WEB-@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"5518184e-3a1a-4fdd-be9d-0759dbf971dc"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"b2ecc125-cb67-4a55-bec6-403506263591","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_7_Cloud","uuid":"94b7eb9c-73a5-4b7e-a9c9-784b6b181f5f"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"HAProxyec2_B","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-HAP-@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"5518184e-3a1a-4fdd-be9d-0759dbf971dc"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"b2ecc125-cb67-4a55-bec6-403506263591","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_7_Cloud","uuid":"94b7eb9c-73a5-4b7e-a9c9-784b6b181f5f"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"MySQLAHV_C","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-vm-DB-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"5518184e-3a1a-4fdd-be9d-0759dbf971dc"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":2,"num_sockets":2,"gpu_list":[],"memory_size_mib":12288,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"b2ecc125-cb67-4a55-bec6-403506263591","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_7_Cloud","uuid":"94b7eb9c-73a5-4b7e-a9c9-784b6b181f5f"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AWS_VM","name":"WebServerec2_C","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{public_ip_address}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-vm-WEB-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-west-2a","subnet_id":"subnet-36f4364e","key_name":"Oregon-CALM","region":"us-west-2","instance_initiated_shutdown_behavior":"","user_data":"#cloud-config\nusers:\n  - name: webadmin\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock-passwd: True\nchpasswd:\n  list: |\n    webadmin:@@{Mysql_password}@@\n  expire: False","image_id":"ami-0818f9dfe739b171e","instance_type":"t2.micro","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-03a26e56c95c34525"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/xvda","iops":100,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-059fee7d","tag_list":[],"type":"","account_uuid":"823417e9-8260-3d4d-e42d-11791071cb87","associate_public_ip_address":true}},"variable_list":[]},{"description":"","action_list":[],"type":"AWS_VM","name":"HAProxyec2_C","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{public_ip_address}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-vm-HAP-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-west-2a","subnet_id":"subnet-36f4364e","key_name":"Oregon-CALM","region":"us-west-2","instance_initiated_shutdown_behavior":"","user_data":"","image_id":"ami-0818f9dfe739b171e","instance_type":"t2.micro","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-03a26e56c95c34525"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/xvda","iops":100,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-059fee7d","tag_list":[],"type":"","account_uuid":"823417e9-8260-3d4d-e42d-11791071cb87","associate_public_ip_address":true}},"variable_list":[]},{"description":"","action_list":[],"type":"VMWARE_VM","name":"MySQLesxi","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.ipAddressList[1]}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"create_spec":{"resources":{"controller_list":{}}}},"os_type":"Linux","create_spec":{"compute_drs_mode":true,"name":"@@{User_initials}@@-vm-DB-@@{calm_array_index}@@-@@{calm_time}@@","type":"PROVISION_VMWARE_VM","drs_mode":true,"cluster":"Cluster1","host":"","resources":{"nic_list":[{"nic_type":"vmxnet3","type":"","net_name":"key-vim.host.PortGroup-VM Network"}],"template_nic_list":[{"nic_type":"vmxnet3","is_deleted":false,"net_name":"key-vim.host.PortGroup-Backplane Network","key":4000,"type":""}],"template_controller_list":[{"controller_type":"ParaVirtualSCSIController","type":"","bus_sharing":"noSharing","is_deleted":false,"key":1000},{"controller_type":"VirtualAHCIController","type":"","is_deleted":false,"key":15000}],"num_vcpus_per_socket":1,"num_sockets":2,"controller_list":[],"memory_size_mib":8192,"power_state":"poweron","guest_customization":{"customization_name":"","cloud_init":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']","linux_data":null,"customization_type":"GUEST_OS_LINUX","type":"","windows_data":null},"template_disk_list":[{"disk_size_mb":-1,"is_deleted":false,"disk_mode":"persistent","device_slot":0,"adapter_type":"SATA","iso_path":"","location":"","key":16000,"controller_key":15000,"disk_type":"cdrom","type":""},{"disk_size_mb":12288,"is_deleted":false,"disk_mode":"persistent","device_slot":0,"adapter_type":"SCSI","iso_path":"","location":"ds:\/\/\/vmfs\/volumes\/4e652813-702600f3\/","key":2000,"controller_key":1000,"disk_type":"disk","type":""}],"type":"","account_uuid":"0110e75f-a0d8-6610-2b3e-9c11a032429f","disk_list":[]},"template":"500e6c19-853d-e329-58c2-abb97ce98663","datastore":"ds:\/\/\/vmfs\/volumes\/4e652813-702600f3\/","storage_drs_mode":false,"storage_pod":"","clone_is_template":false},"variable_list":[]},{"description":"","action_list":[],"type":"AWS_VM","name":"WebServerec2_D","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{public_ip_address}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-vm-WEB-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-west-2a","subnet_id":"subnet-36f4364e","key_name":"Oregon-CALM","region":"us-west-2","instance_initiated_shutdown_behavior":"","user_data":"#cloud-config\nusers:\n  - name: webadmin\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock-passwd: True\nchpasswd:\n  list: |\n    webadmin:@@{Mysql_password}@@\n  expire: False","image_id":"ami-0818f9dfe739b171e","instance_type":"t2.micro","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-03a26e56c95c34525"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/xvda","iops":100,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-059fee7d","tag_list":[],"type":"","account_uuid":"823417e9-8260-3d4d-e42d-11791071cb87","associate_public_ip_address":true}},"variable_list":[]},{"description":"","action_list":[],"type":"AWS_VM","name":"HAProxyec2_D","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{public_ip_address}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-vm-HAP-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-west-2a","subnet_id":"subnet-36f4364e","key_name":"Oregon-CALM","region":"us-west-2","instance_initiated_shutdown_behavior":"","user_data":"","image_id":"ami-0818f9dfe739b171e","instance_type":"t2.micro","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-03a26e56c95c34525"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/xvda","iops":100,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-059fee7d","tag_list":[],"type":"","account_uuid":"823417e9-8260-3d4d-e42d-11791071cb87","associate_public_ip_address":true}},"variable_list":[]},{"description":"","action_list":[],"type":"VMWARE_VM","name":"MySQLec2","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.ipAddressList[1]}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"create_spec":{"resources":{"controller_list":{}}}},"os_type":"Linux","create_spec":{"compute_drs_mode":true,"name":"@@{User_initials}@@-vm-MYSQL-@@{calm_array_index}@@-@@{calm_time}@@","type":"PROVISION_VMWARE_VM","drs_mode":true,"cluster":"Cluster1","host":"","resources":{"nic_list":[{"nic_type":"vmxnet3","type":"","net_name":"key-vim.host.PortGroup-VM Network"}],"template_nic_list":[{"nic_type":"vmxnet3","is_deleted":false,"net_name":"key-vim.host.PortGroup-Backplane Network","key":4000,"type":""}],"template_controller_list":[{"controller_type":"ParaVirtualSCSIController","type":"","bus_sharing":"noSharing","is_deleted":false,"key":1000},{"controller_type":"VirtualAHCIController","type":"","is_deleted":false,"key":15000}],"num_vcpus_per_socket":1,"num_sockets":2,"controller_list":[],"memory_size_mib":8192,"power_state":"poweron","guest_customization":{"customization_name":"","cloud_init":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']","linux_data":null,"customization_type":"GUEST_OS_LINUX","type":"","windows_data":null},"template_disk_list":[{"disk_size_mb":-1,"is_deleted":false,"disk_mode":"persistent","device_slot":0,"adapter_type":"SATA","iso_path":"","location":"","key":16000,"controller_key":15000,"disk_type":"cdrom","type":""},{"disk_size_mb":12288,"is_deleted":false,"disk_mode":"persistent","device_slot":0,"adapter_type":"SCSI","iso_path":"","location":"ds:\/\/\/vmfs\/volumes\/4e652813-702600f3\/","key":2000,"controller_key":1000,"disk_type":"disk","type":""}],"type":"","account_uuid":"0110e75f-a0d8-6610-2b3e-9c11a032429f","disk_list":[]},"template":"500e6c19-853d-e329-58c2-abb97ce98663","datastore":"ds:\/\/\/vmfs\/volumes\/4e652813-702600f3\/","storage_drs_mode":false,"storage_pod":"","clone_is_template":false},"variable_list":[]},{"description":"","action_list":[],"type":"AWS_VM","name":"WebServerec2_E","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{public_ip_address}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-vm-WEB-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-west-2a","subnet_id":"subnet-36f4364e","key_name":"Oregon-CALM","region":"us-west-2","instance_initiated_shutdown_behavior":"","user_data":"#cloud-config\nusers:\n  - name: webadmin\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    lock-passwd: True\nchpasswd:\n  list: |\n    webadmin:@@{Mysql_password}@@\n  expire: False","image_id":"ami-0818f9dfe739b171e","instance_type":"t2.micro","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-03a26e56c95c34525"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/xvda","iops":100,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-059fee7d","tag_list":[],"type":"","account_uuid":"823417e9-8260-3d4d-e42d-11791071cb87","associate_public_ip_address":true}},"variable_list":[]},{"description":"","action_list":[],"type":"AWS_VM","name":"HAProxyec2_E","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{public_ip_address}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"os_type":"Linux","create_spec":{"name":"@@{User_initials}@@-vm-HAP-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-west-2a","subnet_id":"subnet-36f4364e","key_name":"Oregon-CALM","region":"us-west-2","instance_initiated_shutdown_behavior":"","user_data":"","image_id":"ami-0818f9dfe739b171e","instance_type":"t2.micro","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-03a26e56c95c34525"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/xvda","iops":100,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-059fee7d","tag_list":[],"type":"","account_uuid":"823417e9-8260-3d4d-e42d-11791071cb87","associate_public_ip_address":true}},"variable_list":[]}],"credential_definition_list":[{"username":"centos","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"1fUZpJfRqWCF8RTnr+HuppYvgAuoJsEjWeUMLbKYmbfI4+WBxY460w3ihykLSuAJmnvD+Dzwd6kUiHoiOd0HHD5jPPOYXaOCSvmnk18438TfFfcPCPKu1s7UEvzfGAnAWC09+yZfVp7YZPs+2iPnjrbucrLYpv1rNtVdiUpjJfXTjfr1g3Aqm7TcYX0xlb7Vq8pNpETRI93YlWtmFHNsXqP+31BisnKzvWdTTALNvTyU0lnrhthXhfKMuRvswJcDzYj9omqHqkf0TmOFF6xqorwjO9zKjbFouOQ0aBKKjIa4V67emBkMJwoK+c1eZq5WYr4FjJ\/g5T8J+Az1q\/YsGBrDISAYa+1TVEJ7VrVrD3z0gOtKTXTBLEUDYOZBI7l3fasfFxTbQYKP4gWdDwIjTHB3QcFahMw7dRDl8atiPSV4\/kZebypg6OxAqbql2SNeNvXi\/dUWxasi6LDI1my0ptWjLo1F4G\/zCuBqdCriDhyJBpc0W1WkipU2rPDTz\/3uDEWXgmVm8SEtApVrXmROzHxlR9DRj39tjXQWgeQNrHxLmd+hys8iAWkamJ001kfCf40SaJsmq84WU9UYSGHSXy55ARbjL+mRv8o\/415WUGM513dnhxTXxCxodoyxNLmfDqC\/Sn3cxfIfLw322y7gAMWZL7RRUbvGpxhdOoN\/0aOeIdw88HAdowYKlXl6g5V\/azDUlIl8Hfwr7FRTAa\/sMgYBvRan3VRpKGeY+OANgTWBeOedGrEd0UmXAokuUgpW9iE6NuxJCAaa50TeBIUT+DJorz8jUA4TK+0wUYISmSDxsHgjCjJeQDafcmA8C7TYelPw2od2qfeYotWGVwyJEyZhFD+Nc6I+6XqjK\/H8H2ujtIayyUmnZd59W\/aN68WKmZiSreBE8h0uv\/jQbJwC1kLFVKg12MKFML68rI8ZHAB72jqHtMzEQe5jPeQ654XXqnvnJ7Hqg4qCkh0Z+c+COkZtsuDyaKunYXPAe21Rz7OzMYrBNTz622M7GvdRZ3+1\/hD6wbUbd5+2m9Mzhy2xs2qBG788ojf5+9irtT9PGuqq3xvZ2v1STlq8avkYFxARl4kIOLjCYGaOw4uNgWN985\/TDgPCr22+dRqfAwvXYZ9GxN\/KwHha8Z3\/itI8SrIP+Is2v0XAHCSOazuROlZzf7FV\/vCwa6uM4DBtWbVpbIlbxdhGz9MKZwzs1jTSxfeT5FjSV+AvlwR43bKhjYNKaPERixPbwh2ewUNG1m0KV8MyrGUiMM6vbTSTc664\/6vkiUcp4JdXO03\/gf5+L4bbbgcj4zcMH6wK8laS0xsAJENLBaw150NLzH3x+pTVtNdXOFgwsLC5icy8STurdtXXTyhjYlSImMToVMwDBcu2k1hVvLIY6gElza1CFMpql4uz++EKCTmNj9knCR6Dmx4fN2xNUL0HwqSRh\/NEPHvTk3UnxAFHxRq70kBRIOuY3Faxe8sgJ\/fb5eXADQMJ+M5bwyfVh\/3FdUYpwIaVedplPQrR+S0LOejaxfsA+Fe\/psU4fwYWNKGYM9OmzP5hlNvMIGsf2Mps8zGhUFnTC47HtZ\/JcBLKJemtx4B16gWKxDMNVcFtde8fyQdxo+Zg7GUHl7zz10u77QPMDvDGd4o1pnBvmqszQkhP4tfsreHIlDRM2JxsOyGP1UCzH80Vjl7QDGEbjanw+yiJGVEq+X8PSLBtJzWVO0fRcvzhB4vXSPjq+C14a2G0YdRxNFqz7xQGyEu1yhrheFzJsdogx2L2F6py+b9fArEmdwtHKluxFV42NkZ\/WNwj1Q6obm1HKAFhAPHZI1eniiTshww5a1Xebe13VqSXzeH0CbA6jtH1XFGmE9xC3OdGjkBiV1INsHkusbw0GY3g+HAQNQf1iD1LRrfl6usNkQiJoQsI\/PCQ4mysLvwwopNR5aHVsdNBIPFKc2KkoRPS4n7uH+8\/jiCOi2iGdyYEXuAtVGTJvI3wvBxgQSkmGIycqXC1s7WyWKcDAP44GHAWpi6HFL6vHTzdQnabc9yMvDX+O2WW1JlqE\/jhxyfrAyJlg8zYrPMmO6xCrKgM+JdQi1Bkm6b2pYTK6Z5bEoRDwZEvZ8HaK7D2\/iQrJk3oDVT8\/\/PBHAfmAG7g6F0N1+7IdrtAHgJiav28UKJ\/Owvuugd7gNZ9VK\/MF+zNhPuQfRhwCiqfuvDHK7Lhoavf96VgmErpLKwspKVWW+mrndSatULOnMxFT+SYmMeKpTn+TXer8Ger5iFl9BsgCz46FqynYOBqW+k=:utf-8"},"name":"CENTOS"},{"username":"ec2-user","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"rdDxTmA3qRLJdFl6wZqXKoIIukMqOIAt5yw1XsyObDmHOGTMZtxJ9YnXCrIzirwoJpvK2YOysyGY95C24wY3S1I9\/N7QAugvR1cDF38v9PHplB9i\/BWrrj8CU8\/21PEAm6GlUdQ5P+gK1s0iLlGxSFcbZQuEfB2d0DZZQiqvnbU2IOeJSP+ECs2ZKFMioo\/35NgtAdzdj+AIt7diiovtIBdSylOoYOuuo7RmeXEA5DI1K9lia1RhvyKWMJwFFKHzxy+lgw4FjKG\/NGgk3GjtC2FRDyFGD4gJGmXxC+KosLBUPMNZq\/cBEzQalFKvxmif4KvIC68Y6BRg9GF1FdnpdoVzU5XLQ3AjclNOTeTG1MqaHx+o4OZ57SjBltu3WDzClFVVJbEDDlN3SnWJ2pNl+Ja2G+8GqIMRVFLD6h8BGc\/iLgdJH+EhHNrBa04Gi8Ikm2ZoGtYl8QDw7k2qFotEvyGGRoT7cllGx+MAI4adpVU7uiveaaS0A6Gk9omlI5DMoCFCIR2eXRrcBeVf\/OCI6X0IF5HCbaPTjF5YAn8oEfJyx1v+\/PqApUFtjE+QLxrAp\/eJstu0BxQTewseEB\/zYw8OFT6nOn0\/\/jkE5iFTdws+g4GnuAVZWDIDBpeeKq3vv9R3jGbILjxGWWBfCJhOTz60B3q3Sr+FfoSkFvuE5+SZCCH+n3bZZUoLLyVYcvU3sHfkL9eeq136wHmYTJ1AUJHjTiPNYHLGe0g9dNpWd919VPNs7DXHA55sHpH\/aRxmigXGGRf6e3qO5Nxins5ge0YJKcQEZhRcr0aORw+4FeLRt5s4Brlo\/u9i753PuLSmBpqvfwMyIwWT4DV1nQ4QSlhSaJ8iYUtoGzvRHrCYlZcthGk2b3ghQI6sl8QvOWsIs+u2xsXybi56jdn+LZbqrJ7rjmGoeS\/3hXf208zjtJM1Zro8OUTRFBS6BlpeCuRubigfGOEoJjOlSlOlVZAdk1TWiAjZkjDFuXsjqbfKg5lKrf9d7qduOJN7msxQgTpZSUlYjciMbDUDjZQbj3s6GNo8ml2zFG7DNWL7FHbnlSADyJG8FGHHJFVRnba7QYO0El56Fk1qZ2xwUBCqNPx7hIwGRDP4VG2iwYxMFi8nVS3zq17aCS79UNdYjc7Q\/i73T7Powa\/RDYJwefKRRmWytwmuX7r3ccWwgzpMYPuVlGJdTm2ANtS4jhfyqbW21YRAuHbe1EHabCVmUkjJ2+1NFZtG2LsiKBNjR\/mkqXUH6JDmi8G20jQ\/iTWHFPYvP\/hyfZX\/osZIFlVzZ2gWUtunEqFFFcGi0se93CfR8Qzm4J4sH6mENnAbilTzR13wWt4\/Z52J5XNTo5IaeUW9umKW2mb1Y3PbsaRycKbB+wL4pZeGottjbCpbnpgjHUWufYDuxfO7auIfEXApvtfJLhAOSW8hzudGPRIcdCNdBNvN2Z\/2eGY8JZPecWzEY7uFaOSVnZ\/w3XCmyS0mAJ2CBCfBQqCygXnVjunMs0YRZ44Kklp54OpoeqrLAsJq27RRkk9ZoVcURAPolIoAynOAh\/ZHdswT3eFwJnZR5U3p4B1zF4obU37qYzkOKCae6ncC3A+dT\/tgJMN8YsFw+3SiwJuOEmK8mDsAzwGo\/ga8b\/8\/xDxKVBrY2QP+mqA+qFC4COcWOPszMxzLJs11Ox0j6hIYe3d27UrdH6MvPmVNPNNQgSH+7KF+6LYNbgVV+8B7n2ZUCRJIHLtxhXL5OH+8ISqMHzpbADsbAweQKuntsLJHaNPzS45s6aKWZSH2WMxEbG2y+UAWFEAzZwgYSB9qd3ahjjKh+FJhbB8MbvrYzuM1yUQNduxMQvDkgaOh8smMpE9fW6CBd9OPMfjxA3\/Tbf1+CNq8OtvzaMDwvVEBTdqlMrKEpki6z2zMU1vnmJiSfAoh3h95lpp9Kf2kgf\/uJjHLGCyDLnwtcskszpUpaaUc\/9ClfzyrfjS5zeInLEs98REalblX48YQaZ1niAvDVNKGrFeN0dUWl0oUOVQE3ZsEV6RFuiFmdLZxj7eDgSifgTOvVeFVtK7SkC6HMCVJda3UlNpwfLXjidbOKvZBwLvgIsbth8A6xQKL+JVqFnC5f49soTq3aZxu9QwaMYJ7Fhk5e9dNLofyk9WcaorGfvLfPE16kYTTa37UdYjC6m0AQ0Rp7ozq1BEG20BVMQT0WKwIUq5imarF3WmrKZ\/cV4Mvfbi55XOCjLF6ERcs89jWB32gyPrSOwSGSE+SitQELdQomUWwB7ofNoc9gZkBwuwaa5Holvy1o9CmrPV4y1\/M1wKixLT6tA==:utf-8"},"name":"ec2user"},{"username":"centos","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"bYGxrVkHIwZ4pYWVt\/UQJ3EBMU1UEAXTe977zxY7bfIsF1LY\/9XLe408:utf-8"},"name":"userlogin"}],"package_definition_list":[{"description":"CentOS Cloud Image","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"CentOS_7_Cloud","version":"","options":{"type":"","name":"CentOS_7_Cloud","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"http:\/\/download.nutanix.com\/calm\/CentOS-7-x86_64-GenericCloud.qcow2","version":{"product_version":"7","type":"","product_name":"CentOS"},"architecture":"X86_64","type":""},"description":""},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MySQL"}],"name":"mysql_pkg_A","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"mysql_pkg_A"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_sql_A"}],"name":"47db442a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_sql_A","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y \"http:\/\/repo.mysql.com\/mysql-community-release-el7-5.noarch.rpm\"\nsudo yum update -y\nsudo setenforce 0 || true\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\nsudo yum install -y mysql-community-server.x86_64\n\nsudo \/bin\/systemctl start mysqld\nsudo \/bin\/systemctl enable mysqld\n\n#Mysql secure installation\nmysql -u root<<-EOF\n\nUPDATE mysql.user SET Password=PASSWORD('@@{Mysql_password}@@') WHERE User='@@{Mysql_user}@@';\nDELETE FROM mysql.user WHERE User='@@{Mysql_user}@@' AND Host NOT IN ('localhost', '127.0.0.1', '::1');\nDELETE FROM mysql.user WHERE User='';\nDELETE FROM mysql.db WHERE Db='test' OR Db='test\\_%';\n\nFLUSH PRIVILEGES;\nEOF\n\nmysql -u @@{Mysql_user}@@ -p@@{Mysql_password}@@ <<-EOF\nCREATE DATABASE @@{Database_name}@@;\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'%' identified by 'secret';\n\nFLUSH PRIVILEGES;\nEOF","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"d8810a92_runbook","main_task_local_reference":{"kind":"app_task","name":"47db442a_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"mysql_pkg_A"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Unistall_sql"}],"name":"0bda7b49_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Unistall_sql","attrs":{"exit_status":[],"script":"#!\/bin\/bash\necho \"Goodbye!\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"9b78fb77_runbook","main_task_local_reference":{"kind":"app_task","name":"0bda7b49_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer"}],"name":"Install_WebServer_A","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_WebServer_A"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"install_webserver_A"},{"kind":"app_task","name":"customize_php_A"}],"name":"98fa25c2_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"install_webserver_A"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"customize_php_A"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"install_webserver_A","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\nsudo yum -y install epel-release\nsudo setenforce 0\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\nsudo rpm -Uvh https:\/\/mirror.webtatic.com\/yum\/el7\/webtatic-release.rpm\nsudo yum update -y\nsudo yum install -y nginx php56w-fpm php56w-cli php56w-mcrypt php56w-mysql php56w-mbstring php56w-dom git unzip\n\nsudo mkdir -p \/var\/www\/laravel\necho \"server {\n listen 80 default_server;\n listen [::]:80 default_server ipv6only=on;\nroot \/var\/www\/laravel\/public\/;\n index index.php index.html index.htm;\nlocation \/ {\n try_files \\$uri \\$uri\/ \/index.php?\\$query_string;\n }\n # pass the PHP scripts to FastCGI server listening on \/var\/run\/php5-fpm.sock\n location ~ \\.php$ {\n try_files \\$uri \/index.php =404;\n fastcgi_split_path_info ^(.+\\.php)(\/.+)\\$;\n fastcgi_pass 127.0.0.1:9000;\n fastcgi_index index.php;\n fastcgi_param SCRIPT_FILENAME \\$document_root\\$fastcgi_script_name;\n include fastcgi_params;\n }\n}\" | sudo tee \/etc\/nginx\/conf.d\/laravel.conf\nsudo sed -i 's\/80 default_server\/80\/g' \/etc\/nginx\/nginx.conf\nif `grep \"cgi.fix_pathinfo\" \/etc\/php.ini` ; then\n sudo sed -i 's\/cgi.fix_pathinfo=1\/cgi.fix_pathinfo=0\/' \/etc\/php.ini\nelse\n sudo sed -i 's\/;cgi.fix_pathinfo=1\/cgi.fix_pathinfo=0\/' \/etc\/php.ini\nfi\n\nsudo systemctl enable php-fpm\nsudo systemctl enable nginx\nsudo systemctl restart php-fpm\nsudo systemctl restart nginx\n\nif [ ! -e \/usr\/local\/bin\/composer ]\nthen\n curl -sS https:\/\/getcomposer.org\/installer | php\n sudo mv composer.phar \/usr\/local\/bin\/composer\n sudo chmod +x \/usr\/local\/bin\/composer\nfi\n\nsudo git clone https:\/\/github.com\/ideadevice\/quickstart-basic.git \/var\/www\/laravel\nsudo sed -i 's\/DB_HOST=.*\/DB_HOST=@@{MySQL.address}@@\/' \/var\/www\/laravel\/.env\n\nsudo su - -c \"cd \/var\/www\/laravel; composer install\"\nif [ \"@@{calm_array_index}@@\" == \"0\" ]; then\n sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\nfi\n\nsudo chown -R nginx:nginx \/var\/www\/laravel\nsudo chmod -R 777 \/var\/www\/laravel\/\nsudo systemctl restart nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"customize_php_A","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n#Customize Task manager Application\n#Setup background colors RGBs\n   #0 NTNX Turq   rgb(78,178,221);\n   #1 NTNX Orange rgb(242, 173, 56);\n   #3 NTNX Blue   rgb(0, 53, 108;\n   #4 NTNX Green  rgb(172, 209, 71);\ncolors=('rgb(172, 209, 71);', 'rgb(0, 53, 108);', 'rgb(242, 173, 56);', 'rgb(78,178,221);')\nwebserveri=@@{calm_array_index}@@\n#make customizations to the php file\nphpfile=\"\/var\/www\/laravel\/resources\/views\/layouts\/app.blade.php\"\n#Get external IP Aaddress\nmyip=$(curl -4 ifconfig.io)\n#Change Background color\nsed -i \"s\/\\#005495\\;\/${colors[$webserveri]}\/\" $phpfile\n#Change web page title\nsed -i 's\/Laravel Quickstart - Basic\/Nutanix CALM Demonstration\/' $phpfile\nsleep 1\n#CALM specific message and IP address of the targeted webserver\nsed -i \"s\/Task Manager v12.0\/Task Manager v12 Managed by Nutanix CALM<\\\/h2><h2>[webserver IP: $myip]<\\\/h2>\/\" $phpfile\necho \"====Done\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0c37e915_runbook","main_task_local_reference":{"kind":"app_task","name":"98fa25c2_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_WebServer_A"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer"}],"name":"2b29380e_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo rm -rf \/var\/www\/laravel\nsudo yum erase -y nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"22ad09af_runbook","main_task_local_reference":{"kind":"app_task","name":"2b29380e_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HAProxy"}],"name":"Install_HAProxy_pkg_A","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_HAProxy_pkg_A"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_HAProxy_A"}],"name":"5b95926b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_HAProxy_A","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\nsudo yum install -y haproxy\nsudo setenforce 0\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\n\necho \"global\n log 127.0.0.1 local0\n log 127.0.0.1 local1 notice\n maxconn 4096\n quiet\n user haproxy\n group haproxy\ndefaults\n log global\n mode http\n retries 3\n timeout client 50s\n timeout connect 5s\n timeout server 50s\n option dontlognull\n option httplog\n option redispatch\n balance roundrobin\n# Set up application listeners here.\nlisten admin\n bind 127.0.0.1:22002\n mode http\n stats uri \/\nfrontend http\n maxconn 2000\n bind 0.0.0.0:80\n default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@\" | tr \",\" \"\\n\")\nport=80\n\nfor host in $hosts\n  do echo \" server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fe008aea_runbook","main_task_local_reference":{"kind":"app_task","name":"5b95926b_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_HAProxy_pkg_A"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_HAProxy"}],"name":"2665450b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_HAProxy","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo\nyum -y erase haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"16e2263b_runbook","main_task_local_reference":{"kind":"app_task","name":"2665450b_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MySQL"}],"name":"MYSQLpkg_B","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MYSQLpkg_B"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_sql_B"}],"name":"47db442a_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_sql_B","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y \"http:\/\/repo.mysql.com\/mysql-community-release-el7-5.noarch.rpm\"\nsudo yum update -y\nsudo setenforce 0 || true\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\nsudo yum install -y mysql-community-server.x86_64\n\nsudo \/bin\/systemctl start mysqld\nsudo \/bin\/systemctl enable mysqld\n\n#Mysql secure installation\nmysql -u root<<-EOF\n\nUPDATE mysql.user SET Password=PASSWORD('@@{Mysql_password}@@') WHERE User='@@{Mysql_user}@@';\nDELETE FROM mysql.user WHERE User='@@{Mysql_user}@@' AND Host NOT IN ('localhost', '127.0.0.1', '::1');\nDELETE FROM mysql.user WHERE User='';\nDELETE FROM mysql.db WHERE Db='test' OR Db='test\\_%';\n\nFLUSH PRIVILEGES;\nEOF\n\nmysql -u @@{Mysql_user}@@ -p@@{Mysql_password}@@ <<-EOF\nCREATE DATABASE @@{Database_name}@@;\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'%' identified by 'secret';\n\nFLUSH PRIVILEGES;\nEOF","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"d8810a92_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"47db442a_dag_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MYSQLpkg_B"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Unistall_sql_cloned_1"}],"name":"0bda7b49_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Unistall_sql_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\necho \"Goodbye!\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"9b78fb77_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"0bda7b49_dag_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer"}],"name":"Install_WebServer_B","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_WebServer_B"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"install_mysql_B"},{"kind":"app_task","name":"customize_php_B"}],"name":"98fa25c2_dag_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"install_mysql_B"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"customize_php_B"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"install_mysql_B","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\nsudo yum -y install epel-release\nsudo setenforce 0\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\nsudo rpm -Uvh https:\/\/mirror.webtatic.com\/yum\/el7\/webtatic-release.rpm\nsudo yum update -y\nsudo yum install -y nginx php56w-fpm php56w-cli php56w-mcrypt php56w-mysql php56w-mbstring php56w-dom git unzip\n\nsudo mkdir -p \/var\/www\/laravel\necho \"server {\n listen 80 default_server;\n listen [::]:80 default_server ipv6only=on;\nroot \/var\/www\/laravel\/public\/;\n index index.php index.html index.htm;\nlocation \/ {\n try_files \\$uri \\$uri\/ \/index.php?\\$query_string;\n }\n # pass the PHP scripts to FastCGI server listening on \/var\/run\/php5-fpm.sock\n location ~ \\.php$ {\n try_files \\$uri \/index.php =404;\n fastcgi_split_path_info ^(.+\\.php)(\/.+)\\$;\n fastcgi_pass 127.0.0.1:9000;\n fastcgi_index index.php;\n fastcgi_param SCRIPT_FILENAME \\$document_root\\$fastcgi_script_name;\n include fastcgi_params;\n }\n}\" | sudo tee \/etc\/nginx\/conf.d\/laravel.conf\nsudo sed -i 's\/80 default_server\/80\/g' \/etc\/nginx\/nginx.conf\nif `grep \"cgi.fix_pathinfo\" \/etc\/php.ini` ; then\n sudo sed -i 's\/cgi.fix_pathinfo=1\/cgi.fix_pathinfo=0\/' \/etc\/php.ini\nelse\n sudo sed -i 's\/;cgi.fix_pathinfo=1\/cgi.fix_pathinfo=0\/' \/etc\/php.ini\nfi\n\nsudo systemctl enable php-fpm\nsudo systemctl enable nginx\nsudo systemctl restart php-fpm\nsudo systemctl restart nginx\n\nif [ ! -e \/usr\/local\/bin\/composer ]\nthen\n curl -sS https:\/\/getcomposer.org\/installer | php\n sudo mv composer.phar \/usr\/local\/bin\/composer\n sudo chmod +x \/usr\/local\/bin\/composer\nfi\n\nsudo git clone https:\/\/github.com\/ideadevice\/quickstart-basic.git \/var\/www\/laravel\nsudo sed -i 's\/DB_HOST=.*\/DB_HOST=@@{MySQL.address}@@\/' \/var\/www\/laravel\/.env\n\nsudo su - -c \"cd \/var\/www\/laravel; composer install\"\nif [ \"@@{calm_array_index}@@\" == \"0\" ]; then\n sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\nfi\n\nsudo chown -R nginx:nginx \/var\/www\/laravel\nsudo chmod -R 777 \/var\/www\/laravel\/\nsudo systemctl restart nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"customize_php_B","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n#Customize Task manager Application\n#Setup background colors RGBs\n   #0 NTNX Turq   rgb(78,178,221);\n   #1 NTNX Orange rgb(242, 173, 56);\n   #3 NTNX Blue   rgb(0, 53, 108;\n   #4 NTNX Green  rgb(172, 209, 71);\ncolors=('rgb(172, 209, 71);', 'rgb(0, 53, 108);', 'rgb(242, 173, 56);', 'rgb(78,178,221);')\nwebserveri=@@{calm_array_index}@@\n#make customizations to the php file\nphpfile=\"\/var\/www\/laravel\/resources\/views\/layouts\/app.blade.php\"\n#Get external IP Aaddress\nmyip=$(curl -4 ifconfig.io)\n#Change Background color\nsed -i \"s\/\\#005495\\;\/${colors[$webserveri]}\/\" $phpfile\n#Change web page title\nsed -i 's\/Laravel Quickstart - Basic\/Nutanix CALM Demonstration\/' $phpfile\nsleep 1\n#CALM specific message and IP address of the targeted webserver\nsed -i \"s\/Task Manager v12.0\/Task Manager v12 Managed by Nutanix CALM<\\\/h2><h2>[webserver IP: $myip]<\\\/h2>\/\" $phpfile\necho \"====Done\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0c37e915_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"98fa25c2_dag_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_WebServer_B"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer_cloned_1"}],"name":"2b29380e_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo rm -rf \/var\/www\/laravel\nsudo yum erase -y nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"22ad09af_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2b29380e_dag_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HAProxy"}],"name":"Install_HAProxy_pkg_B","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_HAProxy_pkg_B"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_HAProxy_B"}],"name":"5b95926b_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_HAProxy_B","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\nsudo yum install -y haproxy\nsudo setenforce 0\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\n\necho \"global\n log 127.0.0.1 local0\n log 127.0.0.1 local1 notice\n maxconn 4096\n quiet\n user haproxy\n group haproxy\ndefaults\n log global\n mode http\n retries 3\n timeout client 50s\n timeout connect 5s\n timeout server 50s\n option dontlognull\n option httplog\n option redispatch\n balance roundrobin\n# Set up application listeners here.\nlisten admin\n bind 127.0.0.1:22002\n mode http\n stats uri \/\nfrontend http\n maxconn 2000\n bind 0.0.0.0:80\n default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@\" | tr \",\" \"\\n\")\nport=80\n\nfor host in $hosts\n  do echo \" server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fe008aea_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"5b95926b_dag_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_HAProxy_pkg_B"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_HAProxy_cloned_1"}],"name":"2665450b_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_HAProxy_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo\nyum -y erase haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"16e2263b_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2665450b_dag_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MySQL"}],"name":"MYSQL_pkg","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MYSQL_pkg"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_sql"},{"kind":"app_task","name":"setup_tunnel"}],"name":"47db442a_dag_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Install_sql"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"setup_tunnel"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_sql","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y \"http:\/\/repo.mysql.com\/mysql-community-release-el7-5.noarch.rpm\"\nsudo yum update -y\nsudo setenforce 0 || true\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\nsudo yum install -y mysql-community-server.x86_64\n\nsudo \/bin\/systemctl start mysqld\nsudo \/bin\/systemctl enable mysqld\n\n#Mysql secure installation\nmysql -u root<<-EOF\nUPDATE mysql.user SET Password=PASSWORD('@@{Mysql_password}@@') WHERE User='@@{Mysql_user}@@';\nFLUSH PRIVILEGES;\nEOF\n\nmysql -u @@{Mysql_user}@@ -p@@{Mysql_password}@@ <<-EOF\nCREATE DATABASE @@{Database_name}@@;\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'%' identified by 'secret';\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'localhost' identified by 'secret';\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'127.0.0.1' identified by 'secret';\nFLUSH PRIVILEGES;\nEOF","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"setup_tunnel","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y https:\/\/dl.fedoraproject.org\/pub\/epel\/epel-release-latest-7.noarch.rpm\n#sudo yum install -y expect\n#sudo yum install -y autossh\nsudo yum install -y sshpass\n\nwebserver=@@{WebServerec2_C.address}@@\necho \"====webserver: $webserver\"\nsleep 30\n\nIFS=',' \nread -a webs <<<\"$webserver\"\nlen=${#webs[@]}; echo \"len: $len\"\nfor (( i=0; i<$len; i++ )) \n    do\n      currentweb=${webs[$i]}\n      echo \"Start tunnel for $currentweb\"\n      echo \"====About to nohup\"\n      nohup sshpass -p \"@@{Mysql_password}@@\" ssh -o StrictHostKeyChecking=no -R 5555:127.0.0.1:3306 -N webadmin@$currentweb &\n      #echo \"webadmin@$currentweb\"\n      echo \"====Done nohup\"\n    done\necho \"====show jobs\"\njobs\necho \"====show processes\"\nps -aux | grep webadmin\necho \"====Done\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"d8810a92_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"47db442a_dag_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MYSQL_pkg"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Unistall_sql_cloned_1"}],"name":"0bda7b49_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Unistall_sql_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\necho \"Goodbye!\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"9b78fb77_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"0bda7b49_dag_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer"}],"name":"Install_WebServer_pkg","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_WebServer_pkg"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"fix_login_C"},{"kind":"app_task","name":"install_webservices"},{"kind":"app_task","name":"cutomize_php"}],"name":"98fa25c2_dag_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"fix_login_C"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"install_webservices"}},{"from_task_reference":{"kind":"app_task","name":"install_webservices"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"cutomize_php"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"fix_login_C","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n#change sshd to allow password logins\nsudo sed -i 's\/PasswordAuthentication no\/PasswordAuthentication yes\/' \/etc\/ssh\/sshd_config\nsudo systemctl restart sshd\necho @@{WebServerec2_C.address}@@","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"install_webservices","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\n#sudo yum -y install epel-release\n#wget https:\/\/dl.fedoraproject.org\/pub\/epel\/epel-release-latest-7.noarch.rpm -P \/tmp\n#sudo yum install -y \/tmp\/epel-release-latest-7.noarch.rpm\nsudo yum install -y https:\/\/dl.fedoraproject.org\/pub\/epel\/epel-release-latest-7.noarch.rpm\nsudo setenforce 0 || true\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\nsudo rpm -Uvh https:\/\/mirror.webtatic.com\/yum\/el7\/webtatic-release.rpm\n#sudo yum update -y\nsudo yum install -y nginx php56w-fpm php56w-cli php56w-mcrypt php56w-mysql php56w-mbstring php56w-dom git unzip\n\nsudo mkdir -p \/var\/www\/laravel\necho \"server {\n listen 80 default_server;\n listen [::]:80 default_server ipv6only=on;\nroot \/var\/www\/laravel\/public\/;\n index index.php index.html index.htm;\nlocation \/ {\n try_files \\$uri \\$uri\/ \/index.php?\\$query_string;\n }\n # pass the PHP scripts to FastCGI server listening on \/var\/run\/php5-fpm.sock\n location ~ \\.php$ {\n try_files \\$uri \/index.php =404;\n fastcgi_split_path_info ^(.+\\.php)(\/.+)\\$;\n fastcgi_pass 127.0.0.1:9000;\n fastcgi_index index.php;\n fastcgi_param SCRIPT_FILENAME \\$document_root\\$fastcgi_script_name;\n include fastcgi_params;\n }\n}\" | sudo tee \/etc\/nginx\/conf.d\/laravel.conf\nsudo sed -i 's\/80 default_server\/80\/g' \/etc\/nginx\/nginx.conf\nif `grep \"cgi.fix_pathinfo\" \/etc\/php.ini` ; then\n sudo sed -i 's\/cgi.fix_pathinfo=1\/cgi.fix_pathinfo=0\/' \/etc\/php.ini\nelse\n sudo sed -i 's\/;cgi.fix_pathinfo=1\/cgi.fix_pathinfo=0\/' \/etc\/php.ini\nfi\n\nsudo systemctl enable php-fpm\nsudo systemctl enable nginx\nsudo systemctl restart php-fpm\nsudo systemctl restart nginx\n\nif [ ! -e \/usr\/local\/bin\/composer ]\nthen\n curl -sS https:\/\/getcomposer.org\/installer | php\n sudo mv composer.phar \/usr\/local\/bin\/composer\n sudo chmod +x \/usr\/local\/bin\/composer\nfi\n\nsudo git clone https:\/\/github.com\/ideadevice\/quickstart-basic.git \/var\/www\/laravel\nsudo sed -i 's\/DB_HOST=.*\/DB_HOST=127.0.0.1\/' \/var\/www\/laravel\/.env\necho 'DB_PORT=5555' | sudo tee -a \/var\/www\/laravel\/.env\n\nsudo su - -c \"cd \/var\/www\/laravel; composer install\"\n\n#change localhost to 127.0.0.1\nsudo sed -i 's\/localhost\/127\\.0\\.0\\.1\/' \/var\/www\/laravel\/config\/database.php\n#change defaults to homestead - will do two occurences with the first sed\nsudo sed -i 's\/forge\/homestead\/' \/var\/www\/laravel\/config\/database.php\n#Add the password and the port\n\n#add the password\n#sudo sed -i \"s\/'DB_PASSWORD'\\, '')\\,\/'DB_PASSWORD'\\, 'secret')\\,\/\"  \/var\/www\/laravel\/config\/database.php\n\n#port and password\nsudo sed -i \"s\/'DB_PASSWORD'\\, '')\\,\/'DB_PASSWORD'\\, 'secret')\\, 'port' \\=\\> env('DB_PORT'\\, '5555')\\,\/\"  \/var\/www\/laravel\/config\/database.php\n\n#if [ \"@@{calm_array_index}@@\" == \"0\" ]; then\n# sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\n#fi\n\n#Is the ssh tunnel listening on port 5555?\ntunupandrunning=\"DOWN\"\nwhile [[ $tunupandrunning == \"DOWN\" ]]\n do\n   echo \"==Tunnel is DOWN\"\n   sleep 10\n   (netstat -tunl | grep '127.0.0.1:5555') && tunupandrunning=\"UP\"\n done\n echo \"====Tunnel is UP\"\n #sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\n\n#Migrate database only of this is the first webserver\nif [ \"@@{calm_array_index}@@\" == \"0\" ]; then\n sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\nfi\n\nsudo chown -R nginx:nginx \/var\/www\/laravel\nsudo chmod -R 777 \/var\/www\/laravel\/\nsudo systemctl restart nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"cutomize_php","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n#Customize Task manager Application\n#Setup background colors RGBs\n   #0 NTNX Turq   rgb(78,178,221);\n   #1 NTNX Orange rgb(242, 173, 56);\n   #3 NTNX Blue   rgb(0, 53, 108;\n   #4 NTNX Green  rgb(172, 209, 71);\ncolors=('rgb(172, 209, 71);', 'rgb(0, 53, 108);', 'rgb(242, 173, 56);', 'rgb(78,178,221);')\nwebserveri=@@{calm_array_index}@@\n#make customizations to the php file\nphpfile=\"\/var\/www\/laravel\/resources\/views\/layouts\/app.blade.php\"\n#Get external IP Aaddress\nmyip=$(curl -4 ifconfig.io)\n#Change Background color\nsed -i \"s\/\\#005495\\;\/${colors[$webserveri]}\/\" $phpfile\n#Change web page title\nsed -i 's\/Laravel Quickstart - Basic\/Nutanix CALM Demonstration\/' $phpfile\nsleep 1\n#CALM specific message and IP address of the targeted webserver\nsed -i \"s\/Task Manager v12.0\/Task Manager v12 Managed by Nutanix CALM<\\\/h2><h2>[webserver IP: $myip]<\\\/h2>\/\" $phpfile\necho \"====Done\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0c37e915_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"98fa25c2_dag_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_WebServer_pkg"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer_cloned_1"}],"name":"2b29380e_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo rm -rf \/var\/www\/laravel\nsudo yum erase -y nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"22ad09af_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"2b29380e_dag_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HAProxy"}],"name":"Install_HAProxy_pkg","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_HAProxy_pkg"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_HAProxy"}],"name":"5b95926b_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_HAProxy","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\nsudo yum install -y haproxy\nsudo setenforce 0 ||\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\n\necho \"global\n log 127.0.0.1 local0\n log 127.0.0.1 local1 notice\n maxconn 4096\n quiet\n user haproxy\n group haproxy\ndefaults\n log global\n mode http\n retries 3\n timeout client 50s\n timeout connect 5s\n timeout server 50s\n option dontlognull\n option httplog\n option redispatch\n balance roundrobin\n# Set up application listeners here.\nlisten admin\n bind 127.0.0.1:22002\n mode http\n stats uri \/\nfrontend http\n maxconn 2000\n bind 0.0.0.0:80\n default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServerec2_C.address}@@\" | tr \",\" \"\\n\")\nport=80\n\nfor host in $hosts\n  do echo \" server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fe008aea_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"5b95926b_dag_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_HAProxy_pkg"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_HAProxy_cloned_1"}],"name":"2665450b_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_HAProxy_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo\nyum -y erase haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"16e2263b_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"2665450b_dag_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MySQL"}],"name":"MYSQLpkg_D","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MYSQLpkg_D"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_mysql_D"},{"kind":"app_task","name":"setup_tunnel_D"}],"name":"47db442a_dag_cloned_1_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Install_mysql_D"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"setup_tunnel_D"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_mysql_D","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y \"http:\/\/repo.mysql.com\/mysql-community-release-el7-5.noarch.rpm\"\nsudo yum update -y\nsudo setenforce 0 || true\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\nsudo yum install -y mysql-community-server.x86_64\n\nsudo \/bin\/systemctl start mysqld\nsudo \/bin\/systemctl enable mysqld\n\n#Mysql secure installation\nmysql -u root<<-EOF\nUPDATE mysql.user SET Password=PASSWORD('@@{Mysql_password}@@') WHERE User='@@{Mysql_user}@@';\nFLUSH PRIVILEGES;\nEOF\n\nmysql -u @@{Mysql_user}@@ -p@@{Mysql_password}@@ <<-EOF\nCREATE DATABASE @@{Database_name}@@;\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'%' identified by 'secret';\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'localhost' identified by 'secret';\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'127.0.0.1' identified by 'secret';\nFLUSH PRIVILEGES;\nEOF","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"setup_tunnel_D","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y https:\/\/dl.fedoraproject.org\/pub\/epel\/epel-release-latest-7.noarch.rpm\n#sudo yum install -y expect\n#sudo yum install -y autossh\nsudo yum install -y sshpass\nwebserver=@@{WebServerec2_D.address}@@\necho \"====webserver: $webserver\"\nsleep 30\nIFS=',' \nread -a webs <<<\"$webserver\"\nlen=${#webs[@]}; echo \"len: $len\"\nfor (( i=0; i<$len; i++ )) \n    do\n      currentweb=${webs[$i]}\n      echo \"Start tunnel for $currentweb\"\n      echo \"====About to nohup\"\n      nohup sshpass -p \"@@{Mysql_password}@@\" ssh -o StrictHostKeyChecking=no -R 5555:127.0.0.1:3306 -N webadmin@$currentweb &\n      #echo \"webadmin@$currentweb\"\n      echo \"====Done nohup\"\n    done\necho \"====show jobs\"\njobs\necho \"====show processes\"\nps -aux | grep webadmin\necho \"====Done\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"d8810a92_runbook_cloned_1_cloned_0","main_task_local_reference":{"kind":"app_task","name":"47db442a_dag_cloned_1_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MYSQLpkg_D"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Unistall_sql_cloned_1_cloned_1"}],"name":"0bda7b49_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Unistall_sql_cloned_1_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\necho \"Goodbye!\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"9b78fb77_runbook_cloned_1_cloned_0","main_task_local_reference":{"kind":"app_task","name":"0bda7b49_dag_cloned_1_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer"}],"name":"Install_WebServerpkg_D","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_WebServerpkg_D"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"fix_login_D"},{"kind":"app_task","name":"install_webservices_D"},{"kind":"app_task","name":"cutomize_php_D"}],"name":"98fa25c2_dag_cloned_1_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"fix_login_D"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"install_webservices_D"}},{"from_task_reference":{"kind":"app_task","name":"install_webservices_D"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"cutomize_php_D"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"fix_login_D","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n#change sshd to allow password logins\nsudo sed -i 's\/PasswordAuthentication no\/PasswordAuthentication yes\/' \/etc\/ssh\/sshd_config\nsudo systemctl restart sshd\necho @@{WebServerec2_D.address}@@","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"install_webservices_D","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\n#sudo yum -y install epel-release\n#wget https:\/\/dl.fedoraproject.org\/pub\/epel\/epel-release-latest-7.noarch.rpm -P \/tmp\n#sudo yum install -y \/tmp\/epel-release-latest-7.noarch.rpm\nsudo yum install -y https:\/\/dl.fedoraproject.org\/pub\/epel\/epel-release-latest-7.noarch.rpm\nsudo setenforce 0 || true\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\nsudo rpm -Uvh https:\/\/mirror.webtatic.com\/yum\/el7\/webtatic-release.rpm\n#sudo yum update -y\nsudo yum install -y nginx php56w-fpm php56w-cli php56w-mcrypt php56w-mysql php56w-mbstring php56w-dom git unzip\n\nsudo mkdir -p \/var\/www\/laravel\necho \"server {\n listen 80 default_server;\n listen [::]:80 default_server ipv6only=on;\nroot \/var\/www\/laravel\/public\/;\n index index.php index.html index.htm;\nlocation \/ {\n try_files \\$uri \\$uri\/ \/index.php?\\$query_string;\n }\n # pass the PHP scripts to FastCGI server listening on \/var\/run\/php5-fpm.sock\n location ~ \\.php$ {\n try_files \\$uri \/index.php =404;\n fastcgi_split_path_info ^(.+\\.php)(\/.+)\\$;\n fastcgi_pass 127.0.0.1:9000;\n fastcgi_index index.php;\n fastcgi_param SCRIPT_FILENAME \\$document_root\\$fastcgi_script_name;\n include fastcgi_params;\n }\n}\" | sudo tee \/etc\/nginx\/conf.d\/laravel.conf\nsudo sed -i 's\/80 default_server\/80\/g' \/etc\/nginx\/nginx.conf\nif `grep \"cgi.fix_pathinfo\" \/etc\/php.ini` ; then\n sudo sed -i 's\/cgi.fix_pathinfo=1\/cgi.fix_pathinfo=0\/' \/etc\/php.ini\nelse\n sudo sed -i 's\/;cgi.fix_pathinfo=1\/cgi.fix_pathinfo=0\/' \/etc\/php.ini\nfi\n\nsudo systemctl enable php-fpm\nsudo systemctl enable nginx\nsudo systemctl restart php-fpm\nsudo systemctl restart nginx\n\nif [ ! -e \/usr\/local\/bin\/composer ]\nthen\n curl -sS https:\/\/getcomposer.org\/installer | php\n sudo mv composer.phar \/usr\/local\/bin\/composer\n sudo chmod +x \/usr\/local\/bin\/composer\nfi\n\nsudo git clone https:\/\/github.com\/ideadevice\/quickstart-basic.git \/var\/www\/laravel\nsudo sed -i 's\/DB_HOST=.*\/DB_HOST=127.0.0.1\/' \/var\/www\/laravel\/.env\necho 'DB_PORT=5555' | sudo tee -a \/var\/www\/laravel\/.env\n\nsudo su - -c \"cd \/var\/www\/laravel; composer install\"\n\n#change localhost to 127.0.0.1\nsudo sed -i 's\/localhost\/127\\.0\\.0\\.1\/' \/var\/www\/laravel\/config\/database.php\n#change defaults to homestead - will do two occurences with the first sed\nsudo sed -i 's\/forge\/homestead\/' \/var\/www\/laravel\/config\/database.php\n#Add the password and the port\n\n#add the password\n#sudo sed -i \"s\/'DB_PASSWORD'\\, '')\\,\/'DB_PASSWORD'\\, 'secret')\\,\/\"  \/var\/www\/laravel\/config\/database.php\n\n#port and password\nsudo sed -i \"s\/'DB_PASSWORD'\\, '')\\,\/'DB_PASSWORD'\\, 'secret')\\, 'port' \\=\\> env('DB_PORT'\\, '5555')\\,\/\"  \/var\/www\/laravel\/config\/database.php\n\n#if [ \"@@{calm_array_index}@@\" == \"0\" ]; then\n# sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\n#fi\n\n#Is the ssh tunnel listening on port 5555?\ntunupandrunning=\"DOWN\"\nwhile [[ $tunupandrunning == \"DOWN\" ]]\n do\n   echo \"==Tunnel is DOWN\"\n   sleep 10\n   (netstat -tunl | grep '127.0.0.1:5555') && tunupandrunning=\"UP\"\n done\n echo \"====Tunnel is UP\"\n #sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\n\n#Migrate database only of this is the first webserver\nif [ \"@@{calm_array_index}@@\" == \"0\" ]; then\n sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\nfi\n\nsudo chown -R nginx:nginx \/var\/www\/laravel\nsudo chmod -R 777 \/var\/www\/laravel\/\nsudo systemctl restart nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"cutomize_php_D","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n#Customize Task manager Application\n#Setup background colors RGBs\n   #0 NTNX Turq   rgb(78,178,221);\n   #1 NTNX Orange rgb(242, 173, 56);\n   #3 NTNX Blue   rgb(0, 53, 108;\n   #4 NTNX Green  rgb(172, 209, 71);\ncolors=('rgb(172, 209, 71);', 'rgb(0, 53, 108);', 'rgb(242, 173, 56);', 'rgb(78,178,221);')\nwebserveri=@@{calm_array_index}@@\n#make customizations to the php file\nphpfile=\"\/var\/www\/laravel\/resources\/views\/layouts\/app.blade.php\"\n#Get external IP Aaddress\nmyip=$(curl -4 ifconfig.io)\n#Change Background color\nsed -i \"s\/\\#005495\\;\/${colors[$webserveri]}\/\" $phpfile\n#Change web page title\nsed -i 's\/Laravel Quickstart - Basic\/Nutanix CALM Demonstration\/' $phpfile\nsleep 1\n#CALM specific message and IP address of the targeted webserver\nsed -i \"s\/Task Manager v12.0\/Task Manager v12 Managed by Nutanix CALM<\\\/h2><h2>[webserver IP: $myip]<\\\/h2>\/\" $phpfile\necho \"====Done\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0c37e915_runbook_cloned_1_cloned_0","main_task_local_reference":{"kind":"app_task","name":"98fa25c2_dag_cloned_1_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_WebServerpkg_D"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer_cloned_1_cloned_1"}],"name":"2b29380e_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer_cloned_1_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo rm -rf \/var\/www\/laravel\nsudo yum erase -y nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"22ad09af_runbook_cloned_1_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2b29380e_dag_cloned_1_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HAProxy"}],"name":"Install_haproxypkg_d","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_haproxypkg_d"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_haproxy_D"}],"name":"5b95926b_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_haproxy_D","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\nsudo yum install -y haproxy\nsudo setenforce 0 ||\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\n\necho \"global\n log 127.0.0.1 local0\n log 127.0.0.1 local1 notice\n maxconn 4096\n quiet\n user haproxy\n group haproxy\ndefaults\n log global\n mode http\n retries 3\n timeout client 50s\n timeout connect 5s\n timeout server 50s\n option dontlognull\n option httplog\n option redispatch\n balance roundrobin\n# Set up application listeners here.\nlisten admin\n bind 127.0.0.1:22002\n mode http\n stats uri \/\nfrontend http\n maxconn 2000\n bind 0.0.0.0:80\n default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServerec2_D.address}@@\" | tr \",\" \"\\n\")\nport=80\n\nfor host in $hosts\n  do echo \" server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fe008aea_runbook_cloned_1_cloned_0","main_task_local_reference":{"kind":"app_task","name":"5b95926b_dag_cloned_1_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_haproxypkg_d"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_HAProxy_cloned_1_cloned_1"}],"name":"2665450b_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_HAProxy_cloned_1_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo\nyum -y erase haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"16e2263b_runbook_cloned_1_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2665450b_dag_cloned_1_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MySQL"}],"name":"MYSQLpkg_E","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MYSQLpkg_E"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_sql_E"},{"kind":"app_task","name":"setup_tunnel_E"}],"name":"47db442a_dag_cloned_1_cloned_1_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Install_sql_E"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"setup_tunnel_E"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_sql_E","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y \"http:\/\/repo.mysql.com\/mysql-community-release-el7-5.noarch.rpm\"\nsudo yum update -y\nsudo setenforce 0 || true\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\nsudo yum install -y mysql-community-server.x86_64\n\nsudo \/bin\/systemctl start mysqld\nsudo \/bin\/systemctl enable mysqld\n\n#Mysql secure installation\nmysql -u root<<-EOF\nUPDATE mysql.user SET Password=PASSWORD('@@{Mysql_password}@@') WHERE User='@@{Mysql_user}@@';\nFLUSH PRIVILEGES;\nEOF\n\nmysql -u @@{Mysql_user}@@ -p@@{Mysql_password}@@ <<-EOF\nCREATE DATABASE @@{Database_name}@@;\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'%' identified by 'secret';\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'localhost' identified by 'secret';\nGRANT ALL PRIVILEGES ON homestead.* TO '@@{Database_name}@@'@'127.0.0.1' identified by 'secret';\nFLUSH PRIVILEGES;\nEOF","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"setup_tunnel_E","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y https:\/\/dl.fedoraproject.org\/pub\/epel\/epel-release-latest-7.noarch.rpm\n#sudo yum install -y expect\n#sudo yum install -y autossh\nsudo yum install -y sshpass\nwebserver=@@{WebServerec2_E.address}@@\necho \"====webserver: $webserver\"\nsleep 30\nIFS=',' \nread -a webs <<<\"$webserver\"\nlen=${#webs[@]}; echo \"len: $len\"\nfor (( i=0; i<$len; i++ )) \n    do\n      currentweb=${webs[$i]}\n      echo \"Start tunnel for $currentweb\"\n      echo \"====About to nohup\"\n      nohup sshpass -p \"@@{Mysql_password}@@\" ssh -o StrictHostKeyChecking=no -R 5555:127.0.0.1:3306 -N webadmin@$currentweb &\n      #echo \"webadmin@$currentweb\"\n      echo \"====Done nohup\"\n    done\necho \"====show jobs\"\njobs\necho \"====show processes\"\nps -aux | grep webadmin\necho \"====Done\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"d8810a92_runbook_cloned_1_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"47db442a_dag_cloned_1_cloned_1_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MYSQLpkg_E"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Unistall_sql_cloned_1_cloned_1_cloned_1"}],"name":"0bda7b49_dag_cloned_1_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Unistall_sql_cloned_1_cloned_1_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\necho \"Goodbye!\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"9b78fb77_runbook_cloned_1_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"0bda7b49_dag_cloned_1_cloned_1_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer"}],"name":"Install_WebServerpkg_E","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_WebServerpkg_E"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"fix_login_E"},{"kind":"app_task","name":"install_webservices_E"},{"kind":"app_task","name":"cutomize_php_E"}],"name":"98fa25c2_dag_cloned_1_cloned_1_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"fix_login_E"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"install_webservices_E"}},{"from_task_reference":{"kind":"app_task","name":"install_webservices_E"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"cutomize_php_E"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"fix_login_E","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n#change sshd to allow password logins\nsudo sed -i 's\/PasswordAuthentication no\/PasswordAuthentication yes\/' \/etc\/ssh\/sshd_config\nsudo systemctl restart sshd\necho @@{WebServerec2_E.address}@@","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"install_webservices_E","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\n#sudo yum -y install epel-release\n#wget https:\/\/dl.fedoraproject.org\/pub\/epel\/epel-release-latest-7.noarch.rpm -P \/tmp\n#sudo yum install -y \/tmp\/epel-release-latest-7.noarch.rpm\nsudo yum install -y https:\/\/dl.fedoraproject.org\/pub\/epel\/epel-release-latest-7.noarch.rpm\nsudo setenforce 0 || true\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\nsudo rpm -Uvh https:\/\/mirror.webtatic.com\/yum\/el7\/webtatic-release.rpm\n#sudo yum update -y\nsudo yum install -y nginx php56w-fpm php56w-cli php56w-mcrypt php56w-mysql php56w-mbstring php56w-dom git unzip\n\nsudo mkdir -p \/var\/www\/laravel\necho \"server {\n listen 80 default_server;\n listen [::]:80 default_server ipv6only=on;\nroot \/var\/www\/laravel\/public\/;\n index index.php index.html index.htm;\nlocation \/ {\n try_files \\$uri \\$uri\/ \/index.php?\\$query_string;\n }\n # pass the PHP scripts to FastCGI server listening on \/var\/run\/php5-fpm.sock\n location ~ \\.php$ {\n try_files \\$uri \/index.php =404;\n fastcgi_split_path_info ^(.+\\.php)(\/.+)\\$;\n fastcgi_pass 127.0.0.1:9000;\n fastcgi_index index.php;\n fastcgi_param SCRIPT_FILENAME \\$document_root\\$fastcgi_script_name;\n include fastcgi_params;\n }\n}\" | sudo tee \/etc\/nginx\/conf.d\/laravel.conf\nsudo sed -i 's\/80 default_server\/80\/g' \/etc\/nginx\/nginx.conf\nif `grep \"cgi.fix_pathinfo\" \/etc\/php.ini` ; then\n sudo sed -i 's\/cgi.fix_pathinfo=1\/cgi.fix_pathinfo=0\/' \/etc\/php.ini\nelse\n sudo sed -i 's\/;cgi.fix_pathinfo=1\/cgi.fix_pathinfo=0\/' \/etc\/php.ini\nfi\n\nsudo systemctl enable php-fpm\nsudo systemctl enable nginx\nsudo systemctl restart php-fpm\nsudo systemctl restart nginx\n\nif [ ! -e \/usr\/local\/bin\/composer ]\nthen\n curl -sS https:\/\/getcomposer.org\/installer | php\n sudo mv composer.phar \/usr\/local\/bin\/composer\n sudo chmod +x \/usr\/local\/bin\/composer\nfi\n\nsudo git clone https:\/\/github.com\/ideadevice\/quickstart-basic.git \/var\/www\/laravel\nsudo sed -i 's\/DB_HOST=.*\/DB_HOST=127.0.0.1\/' \/var\/www\/laravel\/.env\necho 'DB_PORT=5555' | sudo tee -a \/var\/www\/laravel\/.env\n\nsudo su - -c \"cd \/var\/www\/laravel; composer install\"\n\n#change localhost to 127.0.0.1\nsudo sed -i 's\/localhost\/127\\.0\\.0\\.1\/' \/var\/www\/laravel\/config\/database.php\n#change defaults to homestead - will do two occurences with the first sed\nsudo sed -i 's\/forge\/homestead\/' \/var\/www\/laravel\/config\/database.php\n#Add the password and the port\n\n#add the password\n#sudo sed -i \"s\/'DB_PASSWORD'\\, '')\\,\/'DB_PASSWORD'\\, 'secret')\\,\/\"  \/var\/www\/laravel\/config\/database.php\n\n#port and password\nsudo sed -i \"s\/'DB_PASSWORD'\\, '')\\,\/'DB_PASSWORD'\\, 'secret')\\, 'port' \\=\\> env('DB_PORT'\\, '5555')\\,\/\"  \/var\/www\/laravel\/config\/database.php\n\n#if [ \"@@{calm_array_index}@@\" == \"0\" ]; then\n# sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\n#fi\n\n#Is the ssh tunnel listening on port 5555?\ntunupandrunning=\"DOWN\"\nwhile [[ $tunupandrunning == \"DOWN\" ]]\n do\n   echo \"==Tunnel is DOWN\"\n   sleep 10\n   (netstat -tunl | grep '127.0.0.1:5555') && tunupandrunning=\"UP\"\n done\n echo \"====Tunnel is UP\"\n #sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\n\n#Migrate database only of this is the first webserver\nif [ \"@@{calm_array_index}@@\" == \"0\" ]; then\n sudo su - -c \"cd \/var\/www\/laravel; php artisan migrate\"\nfi\n\nsudo chown -R nginx:nginx \/var\/www\/laravel\nsudo chmod -R 777 \/var\/www\/laravel\/\nsudo systemctl restart nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"cutomize_php_E","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n#Customize Task manager Application\n#Setup background colors RGBs\n   #0 NTNX Turq   rgb(78,178,221);\n   #1 NTNX Orange rgb(242, 173, 56);\n   #3 NTNX Blue   rgb(0, 53, 108;\n   #4 NTNX Green  rgb(172, 209, 71);\ncolors=('rgb(172, 209, 71);', 'rgb(0, 53, 108);', 'rgb(242, 173, 56);', 'rgb(78,178,221);')\nwebserveri=@@{calm_array_index}@@\n#make customizations to the php file\npubdir=\"\/var\/www\/laravel\/public\"\nphpdir=\"\/var\/www\/laravel\/resources\/views\/layouts\"\nphpfile=\"app.blade.php\"\n#Get external IP Aaddress\nmyip=$(curl -4 ifconfig.io)\n#Change Background color\nsed -i \"s\/\\#005495\\;\/${colors[$webserveri]}\/\" \"$phpdir\/$phpfile\"\n#Change web page title\nsed -i 's\/Laravel Quickstart - Basic\/Nutanix CALM Demonstration\/' \"$phpdir\/$phpfile\"\nsleep 1\n#CALM specific message and IP address of the targeted webserver\nsed -i \"s\/Task Manager v12.0<\\\/h2>\/Task Manager v12 Managed by Nutanix CALM<\\\/h2><h2>[webserver IP: $myip]<\\\/h2>XXXXXX\/\" \"$phpdir\/$phpfile\"\nsleep 1\nsed -i \"s\/XXXXXX\/<a href=\\\"{{URL::asset('arch.jpg')}}\\\">See Architecture<\\\/a>\/\" \"$phpdir\/$phpfile\"\n#Get jpg from github\ncd $pubdir && curl -LJO https:\/\/raw.githubusercontent.com\/hardevsanghera\/arch\/master\/arch.jpg\nsudo chmod 777 arch.jpg\nsudo chown nginx:nginx arch.jpg\necho \"====Done\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0c37e915_runbook_cloned_1_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"98fa25c2_dag_cloned_1_cloned_1_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_WebServerpkg_E"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer_cloned_1_cloned_1_cloned_1"}],"name":"2b29380e_dag_cloned_1_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer_cloned_1_cloned_1_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo rm -rf \/var\/www\/laravel\nsudo yum erase -y nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"22ad09af_runbook_cloned_1_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2b29380e_dag_cloned_1_cloned_1_cloned_1"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HAProxy"}],"name":"Install_HAProxy_E","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_HAProxy_E"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install_HAProxy_E"}],"name":"5b95926b_dag_cloned_1_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_HAProxy_E","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\nsudo yum install -y haproxy\nsudo setenforce 0 ||\nsudo sed -i 's\/enforcing\/disabled\/g' \/etc\/selinux\/config \/etc\/selinux\/config\nsudo systemctl stop firewalld || true\nsudo systemctl disable firewalld || true\n\necho \"global\n log 127.0.0.1 local0\n log 127.0.0.1 local1 notice\n maxconn 4096\n quiet\n user haproxy\n group haproxy\ndefaults\n log global\n mode http\n retries 3\n timeout client 50s\n timeout connect 5s\n timeout server 50s\n option dontlognull\n option httplog\n option redispatch\n balance roundrobin\n# Set up application listeners here.\nlisten admin\n bind 127.0.0.1:22002\n mode http\n stats uri \/\nfrontend http\n maxconn 2000\n bind 0.0.0.0:80\n default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServerec2_E.address}@@\" | tr \",\" \"\\n\")\nport=80\n\nfor host in $hosts\n  do echo \" server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"ec2user"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fe008aea_runbook_cloned_1_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"5b95926b_dag_cloned_1_cloned_1_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Install_HAProxy_E"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_HAProxy_cloned_1_cloned_1_cloned_1"}],"name":"2665450b_dag_cloned_1_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_HAProxy_cloned_1_cloned_1_cloned_1","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo\nyum -y erase haproxy","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"16e2263b_runbook_cloned_1_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2665450b_dag_cloned_1_cloned_1_cloned_1"},"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"946a9f13_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"mysql_pkg_A"}],"substrate_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"92495e87_deployment","min_replicas":"1","default_replicas":"2","depends_on_list":[],"editables":{"max_replicas":true},"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Install_WebServer_A"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"366fc8f8_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Install_HAProxy_pkg_A"}],"substrate_local_reference":{"kind":"app_substrate","name":"HAProxyAHV"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"ALLonAHV","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"User_initials","value":"AA","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Mysql_user","value":"root","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"Mysql_password","value":"L4FfX74b0eEo\/Lx7C42lODnctYnJcZP312Es0P0GbNJgnm90TZvdQmCX:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":"SECRET"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Database_name","value":"homestead","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]},{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"83b7b9a6_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"MYSQLpkg_B"}],"substrate_local_reference":{"kind":"app_substrate","name":"MySQLec2_B"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"38d2f5e7_deployment","min_replicas":"1","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Install_WebServer_B"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerec2_B"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"f12a6ca1_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Install_HAProxy_pkg_B"}],"substrate_local_reference":{"kind":"app_substrate","name":"HAProxyec2_B"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"DBonAWS","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"User_initials","value":"BB","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Mysql_user","value":"root","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"Mysql_password","value":"mnXpYhu6Sq54qON80ZOR2mSWv6Tl4HHTzKrn404aQ+ChcWFPzejg:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":"SECRET"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Database_name","value":"homestead","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]},{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"0b532cbd_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"MYSQL_pkg"}],"substrate_local_reference":{"kind":"app_substrate","name":"MySQLAHV_C"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"59074ea2_deployment","min_replicas":"1","default_replicas":"2","depends_on_list":[],"editables":{"min_replicas":true,"default_replicas":true,"max_replicas":true},"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Install_WebServer_pkg"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerec2_C"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"a29f6669_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Install_HAProxy_pkg"}],"substrate_local_reference":{"kind":"app_substrate","name":"HAProxyec2_C"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"DBonAHV","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"User_initials","value":"CC","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Mysql_user","value":"root","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"Mysql_password","value":"4JUunuNf5Podec9xwW2JBglDrk9bSIIQEfY\/1H\/NaY2Zqt7Ncmzb\/dCN:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":"SECRET"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Database_name","value":"homestead","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]},{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"47f2b937_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"MYSQLpkg_D"}],"substrate_local_reference":{"kind":"app_substrate","name":"MySQLesxi"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"5de2c08a_deployment","min_replicas":"1","default_replicas":"2","depends_on_list":[],"editables":{"min_replicas":true,"default_replicas":true,"max_replicas":true},"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Install_WebServerpkg_D"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerec2_D"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"b5ceb830_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Install_haproxypkg_d"}],"substrate_local_reference":{"kind":"app_substrate","name":"HAProxyec2_D"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"DBonESXi","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"User_initials","value":"DD","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Mysql_user","value":"root","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"Mysql_password","value":"AxxoHjQM\/dlGJESS1g1KYwoYJclboPbVkejAEvRDtUVIauGy:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Database_name","value":"homestead","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]},{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"f31e09eb_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"MYSQLpkg_E"}],"substrate_local_reference":{"kind":"app_substrate","name":"MySQLec2"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"f74e1dc8_deployment","min_replicas":"1","default_replicas":"2","depends_on_list":[],"editables":{"min_replicas":true,"default_replicas":true,"max_replicas":true},"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Install_WebServerpkg_E"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerec2_E"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"59411acb_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Install_HAProxy_E"}],"substrate_local_reference":{"kind":"app_substrate","name":"HAProxyec2_E"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"DBonESXiARCH","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"User_initials","value":"EE","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Mysql_user","value":"root","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"Mysql_password","value":"c\/QsXab0kRFujRb7zSkUGs987qV1qeQbZLmTVCYoB2RHqZeU:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Database_name","value":"homestead","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"CENTOS"},"type":"USER"},"name":"3TierTaskMgr-DBonAHVESXiARCH-03112021-1930-HS"},"api_version":"3.0","metadata":{"last_update_time":"1615604264429985","kind":"blueprint","spec_version":33,"creation_time":"1615587586025668","name":"3TierTaskMgr-DBonAHVESXiARCH-03112021-1930-HS"}}